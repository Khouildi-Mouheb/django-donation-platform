<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">

    <!-- BOOTSTRAP CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <title>Notification</title>
</head>
<body>

{% block content %}
<div class="container mt-4">

  <h2 class="mb-3">üîî Notification d√©tail</h2>

  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h4 class="card-title">{{ notif.titre }}</h4>
      <p class="card-text">{{ notif.message|linebreaks }}</p>
      <small class="text-muted">Re√ßue le {{ notif.date_creation|date:"d/m/Y H:i" }}</small>
    </div>
  </div>

  {% if notif.proposition %}

    <div class="card shadow-sm">
      <div class="card-body">

        <h3 class="mb-3">
          Proposition #{{ proposition.id }} ‚Äì {{ proposition.type_materiel }}
        </h3>

        <p><strong>Donateur :</strong> {{ proposition.participant_donateur }}</p>
        <p><strong>Quantit√© :</strong> {{ proposition.quantite }}</p>
        <p><strong>√âtat :</strong> {{ proposition.get_etat_display }}</p>
        <p><strong>Description :</strong> {{ proposition.description }}</p>
        <p><strong>Statut transporteur :</strong> {{ proposition.transporteur_statut }}</p>

        <p>
          <strong>Adresse ramassage :</strong>
          {{ proposition.adresse_ramassage }},
          {{ proposition.ville }} {{ proposition.code_postal }}
        </p>

        <p><strong>Disponibilit√© :</strong> {{ proposition.disponibilite_ramassage }}</p>

        {% if proposition.photos %}
          <img src="{{ proposition.photos.url }}" class="img-fluid rounded mt-2" alt="Photo du don">
        {% endif %}

        <hr>

        {% if proposition.transporteur_statut == "en_attente" %}
          <form method="post" action="{% url 'transporteur_reponse' proposition.id %}" class="mt-3">
              {% csrf_token %}
              <button type="submit" name="action" value="accepter" class="btn btn-success me-2">
                ‚úÖ Accepter
              </button>
              <button type="submit" name="action" value="refuser" class="btn btn-danger">
                ‚ùå Refuser
              </button>
          </form>

        {% elif proposition.transporteur_statut == "acceptee" %}
          <p class="text-success fw-bold mt-2">Vous avez accept√© cette mission.</p>

        {% elif proposition.transporteur_statut == "refusee" %}
          <p class="text-danger fw-bold mt-2">Vous avez refus√© cette mission.</p>

        {% endif %}

      </div>
    </div>
  {% endif %}

  <form method="post" action="{% url 'transporteur_dashboard' %}" class="mt-4">
      {% csrf_token %}
      {% if user.is_authenticated and user.user_type == "transporteur" %}
            <h3>Participant Actions</h3>

            <button name="action">marquer comme terminer</button>
      {% endif %} 
      <button type="submit" class="btn btn-primary">‚¨ÖÔ∏è Retour au tableau de bord</button>
  </form>

</div>
{% endblock %}

<!-- BOOTSTRAP JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
