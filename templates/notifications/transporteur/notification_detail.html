<!-- notifications/transporteur/notification_detail.html -->

{% load static %}

{% block content %}
<div class="container mt-4">
    <h2>Détails de la notification</h2>
    <p><strong>Titre:</strong> {{ notif.titre }}</p>
    <p><strong>Message:</strong> {{ notif.message }}</p>
    <p><strong>Date:</strong> {{ notif.date_created }}</p>
    
    {% if demande %}
        <hr>
        <h4>Détails de la demande</h4>
        <p><strong>ID:</strong> {{ demande.id }}</p>
        <p><strong>Catégorie:</strong> {{ demande.categorie_recherchee }}</p>
        <p><strong>Quantité:</strong> {{ demande.quantite_demandee }}</p>
        <p><strong>Statut:</strong> {{ demande.get_statut_display }}</p>
        <p><strong>Transporteur a confirmé:</strong> {{ demande.transporteur_confirme|yesno:"Oui,Non" }}</p>
        
        {% if not demande.transporteur_confirme %}
            <!-- Form for accepting/refusing the mission -->
            <form method="post">
                {% csrf_token %}
                <p>Voulez-vous accepter cette mission?</p>
                <button type="submit" name="action" value="accepter" class="btn btn-success">Accepter la mission</button>
                <button type="submit" name="action" value="refuser" class="btn btn-danger">Refuser la mission</button>
            </form>
        {% else %}
            <!-- Form for marking as completed -->
            <form method="post">
                {% csrf_token %}
                <button type="submit" name="action" value="marquer comme terminer" class="btn btn-primary">
                    Marquer comme terminée
                </button>
            </form>
        {% endif %}
        
    {% elif proposition %}
        <hr>
        <h4>Détails de la proposition</h4>
        <p><strong>ID:</strong> {{ proposition.id }}</p>
        <p><strong>Catégorie:</strong> {{ proposition.categorie }}</p>
        <p><strong>Type de matériel:</strong> {{ proposition.type_materiel }}</p>
        <p><strong>Quantité:</strong> {{ proposition.quantite }}</p>
        <p><strong>Statut:</strong> {{ proposition.get_statut_display }}</p>
        
        {% if proposition.transporteur_statut %}
            <!-- Form for marking as completed -->
            <form method="post">
                {% csrf_token %}
                <button type="submit" name="action" value="accepter" class="btn btn-primary">
                    accepter
                </button>
            </form>
        {% endif %}
        {% if proposition.donator_gives %}
            <!-- Form for marking as completed -->
            <form method="post">
                {% csrf_token %}
                <button type="submit" name="action" value="marquer comme terminer" class="btn btn-primary">
                    marquer comme terminer
                </button>
            </form>
        {% endif %}
        
    {% endif %}
    
    <a href="{% url 'transporteur_notifications' %}" class="btn btn-secondary mt-3">
        Retour aux notifications
    </a>
</div>
{% endblock %}