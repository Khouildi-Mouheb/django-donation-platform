{% block content %}
<div class="container mt-4">
  <h2>ðŸ“‹ Tableau de bord Membre</h2>

  <h3>Demandes de dons</h3>
  {% for demande in demandes %}
    <div class="card mb-3">
      <div class="card-body">
        <h5>Demande #{{ demande.id }} - {{ demande.type_materiel }}</h5>
        <p><strong>Statut:</strong> {{ demande.get_statut_display }}</p>
        {% if demande.statut == "en_attente" %}
          <form method="post" action="{% url 'traiter_demande' demande.id %}">
            {% csrf_token %}
            <button type="submit" name="action" value="valider" class="btn btn-success">Valider</button>
            <textarea name="raison_refus" class="form-control mt-2" placeholder="Raison du refus"></textarea>
            <button type="submit" name="action" value="refuser" class="btn btn-danger mt-2">Refuser</button>
          </form>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <p>Aucune demande.</p>
  {% endfor %}

  {% for transporteur in transporteurs %}
    <div class="card mb-3">
      <div class="card-body">
        <h5>transporteur #{{ transporteur.id }} - {{ transporteur.username }}</h5>
        <p><strong>disponibilite:</strong> {{ transporteur.disponibilite }}</p>
      </div>
    </div>
  {% empty %}
    <p>Aucune transporteur.</p>
  {% endfor %}

  <h3 class="mt-5">Propositions de dons</h3>
  {% for proposition in propositions %}
    <div class="card mb-3">
      <div class="card-body">
        <h5>Proposition #{{ proposition.id }} - {{ proposition.type_materiel }}</h5>
        <p><strong>Statut:</strong> {{ proposition.get_statut_display }}</p>
        <p><strong>Donateur:</strong> {{ proposition.participant_donateur }}</p>
        <a href="{% url 'proposition_detail' proposition.id %}" class="btn btn-info">Voir dÃ©tails</a>
        {% if proposition.statut == "en_attente" %}
          <form method="post" action="{% url 'traiter_proposition' proposition.id %}" class="mt-2">
            {% csrf_token %}
            <button type="submit" name="action" value="valider" class="btn btn-success">Valider</button>
            <textarea name="raison_refus" class="form-control mt-2" placeholder="Raison du refus"></textarea>
            <button type="submit" name="action" value="refuser" class="btn btn-danger mt-2">Refuser</button>
          </form>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <p>Aucune proposition.</p>
  {% endfor %}
</div>
{% endblock %}
