<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">

    <!-- BOOTSTRAP CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <title>Mes Propositions</title>
</head>
<body>

{% block content %}

<div class="container mt-4">

  <h2 class="mb-4">ðŸ“¦ Mes propositions de dons</h2>

  {% for proposition in propositions %}
    <div class="card mb-3 shadow-sm">
      <div class="card-body">

        <h5 class="card-title mb-3">
          Proposition #{{ proposition.id }} - {{ proposition.type_materiel }}
        </h5>

        <p><strong>QuantitÃ© :</strong> {{ proposition.quantite }}</p>
        <p><strong>Ã‰tat :</strong> {{ proposition.get_etat_display }}</p>
        <p><strong>Description :</strong> {{ proposition.description }}</p>

        <p>
          <strong>Adresse :</strong>
          {{ proposition.adresse_ramassage }},
          {{ proposition.ville }} {{ proposition.code_postal }}
        </p>

        <p><strong>DisponibilitÃ© :</strong> {{ proposition.disponibilite_ramassage }}</p>
        <p><strong>Statut transporteur :</strong> {{ proposition.get_transporteur_statut_display }}</p>

        {% if proposition.membre_validateur %}
          <p><strong>Membre validateur :</strong> {{ proposition.membre_validateur }}</p>
          {% if proposition.membre_validateur %}
  <p><strong>Membre validateur:</strong> {{ proposition.membre_validateur }}</p>
  <a href="{% url 'chat_room' user.id proposition.membre_validateur.id %}" 
     class="btn btn-primary mt-3">
    ðŸ’¬ Contacter le membre
  </a>
{% else %}
  <p><strong>Membre validateur :</strong> Votre proposition nâ€™a pas encore Ã©tÃ© traitÃ©e</p>
{% endif %}


        {% else %}
          <p><strong>Membre validateur :</strong> Votre proposition nâ€™a pas encore Ã©tÃ© traitÃ©e</p>
        {% endif %}

        <hr>

        {% if not proposition.donator_gives %}
          <form method="post" action="{% url 'confirmer_remise_donateur' proposition.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-success">
              âœ… Confirmer remise effectuÃ©e
            </button>
          </form>
        {% else %}
          <p class="text-success fw-bold">Remise confirmÃ©e par vous âœ…</p>
        {% endif %}

      </div>
    </div>

  {% empty %}
    <div class="alert alert-info mt-3">
      Aucune proposition de don.
    </div>
  {% endfor %}

</div>
{% endblock %}

<!-- BOOTSTRAP JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
